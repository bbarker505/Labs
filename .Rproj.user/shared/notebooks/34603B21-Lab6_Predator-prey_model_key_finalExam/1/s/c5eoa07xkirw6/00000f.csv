"0","# Simple Nicholson-Bailey model"
"0","# Agurments are # of time steps, pop growth rate, search efficiency, and search area."
"0","NB_model <- function(time, R, c, a) {"
"0","  "
"0","  # Equations"
"0","  H <- R * log(R)/(a*c*(R-1)) # Starting host density"
"0","  P <- log(R)/a # Starting parasitoid density"
"0","  "
"0","  # Data frame to hold all model outputs, where the first row is for time 0"
"0","  nb_out_all <- data.frame(""Time"" = 0, ""H"" = H+1, ""P"" = P)"
"0","  "
"0","  # Loop through all years in ""time"" (number of years) and calculate H and P, "
"0","  # which are then added to the ""nb_out_all"" data frame"
"0","  for (i in 1:(time-1)) {"
"0","    H <- R * nb_out_all$H[i] * exp(-a * nb_out_all$P[i])"
"0","    P <- c * nb_out_all$H[i] * (1-exp(-a * nb_out_all$P[i]))"
"0","    nb_out_all <- add_row(nb_out_all, Time = i, H = H, P = P)"
"0","  }"
"0","  "
"0","  # Change all values below 1 to 0 "
"0","  nb_out_all <- nb_out_all %>%"
"0","    mutate(H = ifelse(H < 1, 0, H), P = ifelse(P < 1, 0, P))"
"0","  "
"0","  # Return the results from the function"
"0","  return(nb_out_all)"
"0","}"
